<!DOCTYPE html>
<html>
<head>
  <title>TVK Live Voice Chat</title>
  <script src="https://cdn.agora.io/sdk/release/AgoraRTC_N.js"></script>
  <style>
    body {
      background: linear-gradient(to right, orange, white, green);
      text-align: center;
      font-family: Arial, sans-serif;
    }
    h2 {
      margin-top: 50px;
      font-size: 24px;
      color: #111;
    }
    button {
      margin: 10px;
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    .join { background-color: orange; color: white; }
    .leave { background-color: red; color: white; }
    .mute { background-color: green; color: white; }
  </style>
</head>
<body>

  <h2>üé§ TVK Live Voice Chat</h2>

  <button class="join" onclick="join()">Join Chat</button>
  <button class="leave" onclick="leave()">Leave Chat</button>
  <button class="mute" onclick="toggleMute()">Mute / Unmute</button>

  <p id="status" style="color: red;"></p>

  <script>
    const APP_ID = "8b8a4cda5a3e43c8ad71751ae8b42558";
    const CHANNEL = "tvkroom";
    const TOKEN = "007eJxTYHgqeu3ovIfPplmfk3zbc+m4AGue4IV/4kvC5uYe02G5uaJCgcEiySLRJDkl0TTRONXEONkiMcXc0NzUMDHVIsnEyNTU4pF5c0ZDICNDiv88BkYoBPHZGQKKEstSU/MYGABXgSI3";

    let client;
    let localAudioTrack;
    let isMuted = false;

    async function join() {
      try {
        client = AgoraRTC.createClient({ mode: "rtc", codec: "vp8" });
        await client.join(APP_ID, CHANNEL, TOKEN, null);

        localAudioTrack = await AgoraRTC.createMicrophoneAudioTrack();
        await client.publish([localAudioTrack]);

        document.getElementById("status").innerText = "‚úÖ Joined voice chat";
        console.log("Joined voice chat");
      } catch (err) {
        document.getElementById("status").innerText = "‚ùå " + err.message;
        console.error("Join failed", err);
      }
    }

    async function leave() {
      if (localAudioTrack) {
        localAudioTrack.stop();
        localAudioTrack.close();
      }
      if (client) {
        await client.leave();
      }
      document.getElementById("status").innerText = "üëã Left the chat";
    }

    function toggleMute() {
      if (!localAudioTrack) return;
      isMuted = !isMuted;
      localAudioTrack.setEnabled(!isMuted);
      document.getElementById("status").innerText = isMuted ? "üîá Muted" : "üé§ Unmuted";
    }
  </script>
</body>
</html>
